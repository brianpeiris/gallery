<div class="icon-museum" ng-controller="MainCtrl">
    
  <div id="cell-view" ng-class="{cr:cr, ic: r.cellId||(set&&set.children_are_cells) ,fs:fs}">

    <section id="sheet">
    
      <div id="space" sp-kbd="['space', 'right', 'j', 'down', 'pagedown']" ng-class="spaceClass" ng-controller="3DController">
        <three-viewport></three-viewport>
      </div>
    
      <button class="overlaybutton" sp-tap="p(r.setId&&'set/'+r.setId + '/'||r.view+'/')" id="back-button">
        <span class="overlaybutton-inner icon-back"></span>
      </button>
      
      <button class="overlaybutton" sp-tap="fs=!fs;fullscreen()" sp-kbd="'f'" id="fullscreen-button">
          <span class="overlaybutton-inner" ng-class="fs&&'icon-min'||'icon-max'"></span>
      </button>
      
      <button class="overlaybutton" sp-tap="cr=!cr" sp-kbd="'i'" id="aside-button">
          <span class="overlaybutton-inner icon-info"></span>
      </button>
    </section>
  
    <aside resizable r-directions="['left']" r-min-width="500" >
      <article id="info">
          <h1>{{cells[cells.getIndex(r.cellId)].name}}</h1>
          
          <div ng-controller="StratificationController" style="margin: 5px">
            <chart bindto-id="chart-stratification"  chart="chart"  
            on-legend-click="onLegendClick(cellId)"
            on-legend-mouseover="onLegendMouseover(cellId)"
            on-legend-mouseout="onLegendMouseout(cellId)"></chart>
          </div> 

          <ul class="list">
              <li>
                  <div class="group">
                    <a sp-if="auth.isAdmin()" sp-tap="modal('components/add.html')" class="btn icon-copy flex"></a>
                    <a sp-if="auth.isAdmin()" sp-tap="modal('components/confirm.html')" class="btn danger icon-bin flex"></a>
                  </div>
              </li>
              <li sp-if="cells.get(r.cellId).description.length">
                  <q>{{_.description}}</q>
                  {{cells.get(r.cellId).description}}
              </li>
              <li class="drop" sp-tap="c=!c" ng-class="{'active':c}" sp-if="cells.get(r.cellId).copyright.length">
                  <q>{{_.copyright}}</q>
                  <p ng-show="c">{{cells.get(r.cellId).copyright}}</p>
              </li>
          </ul>
      </article>
    </aside>
  </div>
  
  <aside id="menu">
  
    <ul>   
      <li sp-tap="p('sets/')" ng-class="{open: r.view == 'sets'}">
        <i class="icon-sets"></i>
        <span>{{_.sets}}</span>
      </li>

      <li sp-tap="p('catalog/')" sp-kbd="'b'" ng-class="{open: r.view == 'catalog'}">
        <i class="icon-book"></i>
        <span>{{_.catalog}}</span>
      </li>
   
      <li sp-tap="p('search/')" sp-kbd="'/'" ng-class="{open: r.view == 'search'}">
        <i class="icon-search"></i>
        <span>{{_.search}}</span>
      </li>
   
      <li sp-tap="modal('components/settings.html')" sp-kbd="[',', 'command+,', 'control+,']">
        <i class="icon-cog"></i>
        <span>{{_.settings}}</span>
      </li>
  
    </ul>
  </aside>
  
  <div ng-include="'app/menu/navigation.html'"></div>

</div>