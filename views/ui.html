 <div class="icon-cellpane" ng-controller="uiController">
<!--     Menu on the right with cell details -->    
    <div id="cell-view" ng-class="{cr:cr,ic:r.cellId,fs:fs}">
        <aside>
            <article id="info">
                <h1>{{cells[r.cellId].name}}</h1>
                <ul class=list>
                    <li>
                        <div class=group>
                            <a class="btn icon-add flex" sp-tap="modal('views/add.html')" id=add_to_set></a>
                            <a sp-tap="editcell(true)" class="btn icon-copy flex"></a>
                            <a sp-if=iscellOwner() sp-tap="editcell()" class="btn icon-pencil flex"></a>
                            <a sp-if=iscellOwner() sp-tap="modal('views/confirm.html')" class="btn danger icon-bin flex"></a>
                        </div>
                    </li>
                    <li>
                        <q>{{_.key}}</q>
                        <span class=select-wrap sp-if=canChangeKey()>
                            <select ng-change="updateKey(k)+clean('k')" ng-model=k ng-options="k for k in getKeys()"></select>
                            <span class="select btn">{{k}}</span>
                        </span>
                        <span sp-if=!canChangeKey()>{{k}}</span>
                        &nbsp;({{cells[r.cellId].key}})</li>
                    <li>
                        <q>{{_.tempo}}</q>
                        {{cells[r.cellId].tempo}}
                    </li>
                    <li>
                        <q>{{_.signature}}</q>
                        {{cells[r.cellId].signature}}</li>
                    <li>
                        <q>{{_.artist}}</q>
                        <p>{{cells[r.cellId].artists.join(', ')}}</p>
                    </li>
                    <li class=drop sp-tap="c=!c" ng-class="{'active':c}">
                        <q>{{_.copyright}}</q>
                        <p ng-show=c>{{cells[r.cellId].copyright}}</p>
                    </li>
                </ul>
            </article>
        </aside>
        <section id="sheet">
            <div id=space sp-tap=nextcell() sp-kbd="['space', 'right', 'j', 'down', 'pagedown']" ng-class=spaceClass>
<!--                 <article sp-slide=cellSlide>
                    <div ng-class="{m:s.fontSize==1,l:s.fontSize==2,h:s.hideChords}" class=cell-wrap>
                        <p ng-repeat="part in model" ng-class="'part-'+part.type" ng-bind-html-unsafe=part.text></p>
                    </div>
                </article> -->
                
                    <!--A directive is the reusable package created with AngularJS-->
                    <!--This directive wraps Three JS-->
                    <div three-viewport></div>
            </div>
            <button class=overlaybutton sp-tap="p(r.setId&&'set/'+r.setId + '/'||r.view+'/')" id="back-button">
                <span class="overlaybutton-inner icon-back"></span>
            </button>
            <button class=overlaybutton sp-tap="fs=!fs" sp-kbd="'f'" id="fullscreen-button">
                <span class=overlaybutton-inner ng-class="fs&&'icon-min'||'icon-max'"></span>
            </button>
            <button class=overlaybutton sp-tap="cr=!cr" sp-kbd="'i'" id="aside-button">
                <span class="overlaybutton-inner icon-info"></span>
            </button>
        </section>
    </div>
    <aside id=menu>
        <!-- Dark menu on the left -->
        <ul> 
            <li sp-tap="p('catalog/')" sp-kbd="'b'" ng-class="{open: r.view == 'catalog'}"><i class=icon-book></i><span>{{_.catalog}}</span></li>
            <li sp-tap="p('sets/')" ng-class="{open: r.view == 'sets'}"><i class=icon-sets></i><span>{{_.sets}}</span></li>
            <li sp-tap="p('search/')" sp-kbd="'/'" ng-class="{open: r.view == 'search'}"><i class=icon-search></i><span>{{_.search}}</span></li>
            <li sp-tap="modal('views/settings.html')" sp-kbd="[',', 'command+,', 'control+,']"><i class=icon-cog></i><span>{{_.settings}}</span></li>
        </ul>
    </aside>
    <section id=nav class="fill w" ng-class={open:menu}>
        <header>
            <div class=b sp-tap="toggleState('menu')" sp-kbd="'m'" ng-class={on:menu}><i class=icon-more></i></div>
            <div class=b sp-tap="modal('views/new.html')" sp-kbd="'n'" ng-class="{on:modal.isOn('new')}"><i class=icon-plus></i></div>
            <h1 sp-tap="p('sets/')" sp-kbd="'s'">
            <b>Cell</b>Gallery</h1>
            </header>
        <div id="view" ng-class="navClass">
                <article sp-slide=viewSlide id={{model}} ng-include="'views/'+model + '-template.html'"></article>
            </div>
        </section>
    </div>